{% extends 'base.html' %}
{% block title %}Dashboard | Administraci√≥n{% endblock %}

{% block extra_styles %}
<style>
    /* Estilos Espec√≠ficos del Dashboard */

    /* Contenedor Principal (Dentro del 'content' del base.html) */
    .dashboard-container {
        padding: 30px;
        background-color: #f7f9fc;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    }

    /* T√≠tulos */
    h1 {
        color: #1e40af; /* Azul oscuro corporativo */
        font-size: 2.5em;
        margin-bottom: 5px;
        font-weight: 700;
    }

    h2 {
        color: #495057;
        font-size: 1.8em;
        margin-top: 35px;
        margin-bottom: 20px;
        border-bottom: 2px solid #e6e9f5;
        padding-bottom: 10px;
    }

    /* GRID de M√©tricas (Tarjetas) */
    .metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 25px;
    }

    .metric-card {
        background: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        border-left: 5px solid #007bff;
        transition: transform 0.3s ease;
    }

    .metric-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
    }

    .metric-card:nth-child(1) { border-left-color: #28a745; /* Verde para Ventas Totales */ }
    .metric-card:nth-child(2) { border-left-color: #ffc107; /* Amarillo para Transacciones */ }
    .metric-card:nth-child(3) { border-left-color: #17a2b8; /* Cyan para Ticket Promedio */ }
    .metric-card:nth-child(4) { border-left-color: #dc3545; /* Rojo para Sesiones Activas */ }

    .metric-card h3 {
        color: #6c757d;
        font-size: 1em;
        margin-top: 0;
        margin-bottom: 10px;
        text-transform: uppercase;
        font-weight: 600;
    }

    .metric-card p {
        font-size: 2.8em; /* Tama√±o grande para la cifra */
        font-weight: bold;
        color: #343a40;
        margin: 0;
        line-height: 1.1;
    }

    /* Colores espec√≠ficos para los valores */
    .metric-card:nth-child(1) p { color: #28a745; }
    .metric-card:nth-child(3) p { font-size: 2.4em; } /* Ticket promedio un poco m√°s chico */

    /* TABLA DE TOP PRODUCTOS */
    .top-products-section {
        margin-top: 50px;
    }
    /* ... (Estilos de tabla) ... */

    /* ‚úÖ ESTILOS PARA LA BARRA DE BOTONES S√ìLIDOS (<form> y <button>) */
    .nav-grid {
        /* Contenedor de la barra de botones */
        display: flex;
        flex-wrap: wrap;
        gap: 12px; /* Espacio entre los botones */
        margin-top: 20px;
        padding: 15px;
        border-radius: 8px;
    }

    /* OJO: Aplicamos el estilo de bot√≥n a la clase 'btn-nav-action' en el <button> */
    .btn-nav-action {
        display: inline-flex;
        align-items: center;
        color: white;
        padding: 12px 20px;
        border-radius: 6px;
        font-weight: 600;
        font-size: 1em;
        transition: background-color 0.2s, transform 0.1s;
        gap: 10px;
        border: none;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        background-color: #3b82f6;
    }

    .btn-nav-action:hover {
        background-color: #1e40af;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    /* Estilo del ICONO dentro del bot√≥n */
    .btn-nav-action i {
        font-size: 1.1em;
        color: white;
        padding: 0;
        width: auto;
        height: auto;
        box-shadow: none;
        background-color: transparent;
    }

    /* Colores √∫nicos por bot√≥n (Usamos :nth-child en el FORM para afectar al button interno) */
    .nav-grid form:nth-child(1) .btn-nav-action { background-color: #17a2b8; } /* Inventario (Cyan) */
    .nav-grid form:nth-child(2) .btn-nav-action { background-color: #28a745; } /* Resumen Mensual (Verde) */
    .nav-grid form:nth-child(3) .btn-nav-action { background-color: #ffc107; color: #343a40; } /* Inventario Proveedor (Amarillo/Negro) */
    .nav-grid form:nth-child(4) .btn-nav-action { background-color: #dc3545; } /* Reporte Ventas (Rojo) */

</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <h1>üìä Dashboard de Administraci√≥n</h1>

    <h2>üìÖ M√©tricas del D√≠a (Hoy)</h2>

    <div class="metrics-grid">
        <div class="metric-card">
            <h3>üí∞ Ventas Totales Hoy</h3>
            <p>${{ ventas_hoy|floatformat:2 }}</p>
        </div>

        <div class="metric-card">
            <h3>üßæ Transacciones Hoy</h3>
            <p>{{ transacciones_hoy }}</p>
        </div>

        <div class="metric-card">
            <h3>üìà Ticket Promedio</h3>
            <p>${{ ticket_promedio|floatformat:2 }}</p>
        </div>

        <div class="metric-card">
            <h3>üü¢ Sesiones de Caja Activas</h3>
            <p>{{ sesiones_activas }}</p>
        </div>
    </div>

    <div class="top-products-section">
        <h2>üèÜ Top 5 Productos M√°s Vendidos (Hist√≥rico)</h2>
        <table>
            <thead>
                <tr>
                    <th>Producto</th>
                    <th style="text-align: right;">Cantidad Vendida</th>
                </tr>
            </thead>
            <tbody>
                {% for product in top_products %}
                <tr>
                    <td>{{ product.product__name }}</td>
                    <td style="text-align: right;">{{ product.total_sold }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="2">No hay datos de ventas a√∫n.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <h2>‚öôÔ∏è Navegaci√≥n R√°pida y Reportes Adicionales</h2>

    <div class="nav-grid">
        <form method="get" action="{% url 'product_list' %}">
            <button type="submit" class="btn-nav-action">
                <i class="fas fa-boxes"></i>
                Inventario Detallado y Stock Bajo
            </button>
        </form>

        <form method="get" action="{% url 'monthly_summary' %}">
            <button type="submit" class="btn-nav-action">
                <i class="fas fa-chart-bar"></i>
                Resumen Agrupado de Ventas Mensuales
            </button>
        </form>

        <form method="get" action="{% url 'supplier_inventory' supplier_id=1 %}">
            <button type="submit" class="btn-nav-action">
                <i class="fas fa-truck-loading"></i>
                Inventario por Proveedor
            </button>
        </form>
    </div>
</div>
{% endblock %}