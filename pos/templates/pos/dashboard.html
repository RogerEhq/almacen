{% extends 'base.html' %}
{% block title %}Dashboard | Administraci√≥n{% endblock %}

{% block extra_styles %}
<style>
    /* Estilos Espec√≠ficos del Dashboard */

    /* Contenedor Principal (Dentro del 'content' del base.html) */
    .dashboard-container {
        padding: 30px;
        background-color: #f7f9fc;
        border-radius: 12px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
    }

    /* T√≠tulos */
    h1 {
        color: #1e40af; /* Azul oscuro corporativo */
        font-size: 2.5em;
        margin-bottom: 5px;
        font-weight: 700;
    }

    h2 {
        color: #495057;
        font-size: 1.8em;
        margin-top: 35px;
        margin-bottom: 20px;
        border-bottom: 2px solid #e6e9f5;
        padding-bottom: 10px;
    }

    /* GRID de M√©tricas (Tarjetas) */
    .metrics-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 25px;
    }

    .metric-card {
        background: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
        border-left: 5px solid #007bff;
        transition: transform 0.3s ease;
    }

    .metric-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
    }

    .metric-card:nth-child(1) { border-left-color: #28a745; /* Verde para Ventas Totales */ }
    .metric-card:nth-child(2) { border-left-color: #ffc107; /* Amarillo para Transacciones */ }
    .metric-card:nth-child(3) { border-left-color: #17a2b8; /* Cyan para Ticket Promedio */ }
    .metric-card:nth-child(4) { border-left-color: #dc3545; /* Rojo para Sesiones Activas */ }

    .metric-card h3 {
        color: #6c757d;
        font-size: 1em;
        margin-top: 0;
        margin-bottom: 10px;
        text-transform: uppercase;
        font-weight: 600;
    }

    .metric-card p {
        font-size: 2.8em; /* Tama√±o grande para la cifra */
        font-weight: bold;
        color: #343a40;
        margin: 0;
        line-height: 1.1;
    }

    /* Colores espec√≠ficos para los valores */
    .metric-card:nth-child(1) p { color: #28a745; }
    .metric-card:nth-child(3) p { font-size: 2.4em; } /* Ticket promedio un poco m√°s chico */

    /* TABLA DE TOP PRODUCTOS */
    .top-products-section {
        margin-top: 50px;
    }

    .top-products-section table {
        width: 100%;
        max-width: 600px; /* Limitar el ancho para enfoque */
        border-collapse: separate;
        border-spacing: 0;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        background: white;
    }

    .top-products-section th, .top-products-section td {
        padding: 15px 20px;
        text-align: left;
        border-bottom: 1px solid #e9ecef;
    }

    .top-products-section th {
        background-color: #eef2ff;
        color: #1e40af;
        font-weight: 600;
        text-transform: uppercase;
    }

    .top-products-section tbody tr:hover {
        background-color: #f6f8ff;
    }

    .top-products-section tbody tr:last-child td {
        border-bottom: none;
    }

    .top-products-section td:last-child {
        font-weight: bold;
        color: #343a40;
    }

    .top-products-section td[colspan="2"] {
        text-align: center;
        font-style: italic;
        color: #999;
    }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <h1>üìä Dashboard de Administraci√≥n</h1>

    <h2>üìÖ M√©tricas del D√≠a (Hoy)</h2>

    <div class="metrics-grid">

        <div class="metric-card">
            <h3>üí∞ Ventas Totales Hoy</h3>
            <p>${{ ventas_hoy|floatformat:2 }}</p>
        </div>

        <div class="metric-card">
            <h3>üßæ Transacciones Hoy</h3>
            <p>{{ transacciones_hoy }}</p>
        </div>

        <div class="metric-card">
            <h3>üìà Ticket Promedio</h3>
            <p>${{ ticket_promedio|floatformat:2 }}</p>
        </div>

        <div class="metric-card">
            <h3>üü¢ Sesiones de Caja Activas</h3>
            <p>{{ sesiones_activas }}</p>
        </div>
    </div>

    <div class="top-products-section">
        <h2>üèÜ Top 5 Productos M√°s Vendidos (Hist√≥rico)</h2>

        <table>
            <thead>
                <tr>
                    <th>Producto</th>
                    <th style="text-align: right;">Cantidad Vendida</th>
                </tr>
            </thead>
            <tbody>
                {% for product in top_products %}
                <tr>
                    <td>{{ product.product__name }}</td>
                    <td style="text-align: right;">{{ product.total_sold }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="2">No hay datos de ventas a√∫n.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}