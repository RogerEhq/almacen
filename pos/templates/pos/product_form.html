{% extends 'base.html' %} 

{% block title %}Reabastecer Stock: {{ product.name }}{% endblock %}

{% block content %}
<div class="container" style="max-width: 600px; margin: 50px auto; padding: 30px; background: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">
    <h1 style="font-size: 2rem; color: #1e40af; margin-bottom: 25px; border-bottom: 2px solid #e0e0e0; padding-bottom: 10px;">
        üöö Reabastecer: {{ product.name }}
    </h1>

    <div style="margin-bottom: 20px;">
        <p style="font-size: 1.1rem; color: #6c757d; font-weight: 500;">
            Est√°s actualizando el inventario. Ingresa el **stock total nuevo** despu√©s del reabastecimiento.
        </p>
    </div>

    <form method="post">
        {% csrf_token %}

        {# Muestra errores no espec√≠ficos de campo #}
        {% if form.non_field_errors %}
        <div style="padding: 10px; margin-bottom: 20px; border: 1px solid #dc3545; background-color: #f8d7da; color: #721c24; border-radius: 4px;">
            <p style="font-weight: bold;">‚ö†Ô∏è Error al Guardar:</p>
            {{ form.non_field_errors }}
        </div>
        {% endif %}

        <div style="background-color: #f8f9fa; padding: 20px; border-radius: 8px;">
            <h3 style="color: #007bff; border-bottom: 1px solid #dee2e6; padding-bottom: 10px; margin-top: 0;">Stock y Umbral</h3>

            <p style="font-weight: 600;"> SKU: {{ product.sku }} | Costo: ${{ product.cost|floatformat:2 }} | Venta: ${{ product.price|floatformat:2 }} </p>

            {# Campo Stock Actual #}
            <div class="form-group" style="margin-bottom: 25px;">
                <label for="{{ form.stock.id_for_label }}" style="font-weight: 600; display: block; font-size: 1.2em;">{{ form.stock.label }}:</label>
                {{ form.stock }}
                <small style="color: #007bff; font-weight: 600;">Stock antes de guardar: {{ product.stock }} unidades.</small>
                {% if form.stock.errors %}<p style="color: red; font-size: 0.9em;">{{ form.stock.errors }}</p>{% endif %}
            </div>

            {# Campo Umbral de Stock Bajo #}
            <div class="form-group" style="margin-bottom: 15px;">
                <label for="{{ form.low_stock_threshold.id_for_label }}" style="font-weight: 600; display: block;">{{ form.low_stock_threshold.label }}:</label>
                {{ form.low_stock_threshold }}
                {% if form.low_stock_threshold.errors %}<p style="color: red; font-size: 0.9em;">{{ form.low_stock_threshold.errors }}</p>{% endif %}
            </div>
        </div>

        {# ELIMINADA: La secci√≥n "Otros Datos" que conten√≠a name, price, sku, etc. #}

        <button
            type="submit"
            style="margin-top: 25px; padding: 12px 25px; background-color: #28a745; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; transition: background-color 0.3s;"
        >
            <i class="fas fa-box-open"></i> Guardar Nuevo Stock
        </button>

        <a href="{% url 'low_inventory_alert' %}" style="margin-left: 15px; color: #dc3545; text-decoration: none; font-weight: 600;">
            <i class="fas fa-arrow-left"></i> Volver a Alertas
        </a>
    </form>
</div>

<style>
    /* Estilos para que el formulario se vea limpio */
    .form-group input[type="text"],
    .form-group input[type="number"],
    .form-group select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ced4da;
        border-radius: 4px;
        box-sizing: border-box;
        margin-top: 5px;
    }
    .form-group label {
        display: block;
        font-weight: 600;
        margin-bottom: 5px;
    }
    .form-control-lg {
        font-size: 1.5em; /* Destacar el campo de stock */
        height: auto;
        padding: 15px 10px;
        border-color: #28a745;
    }
</style>
{% endblock %}